<h1 id="unitrie-node-identifiers">Unitrie node identifiers</h1>

<table>
  <thead>
    <tr>
      <th style="text-align: left">RSKIP</th>
      <th style="text-align: left">112</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>Title</strong></td>
      <td style="text-align: left">Unitrie Node identifiers</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Created</strong></td>
      <td style="text-align: left">2019</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Author</strong></td>
      <td style="text-align: left">SDL</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Layer</strong></td>
      <td style="text-align: left">Sec, Sca</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Complexity</strong></td>
      <td style="text-align: left">1</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Status</strong></td>
      <td style="text-align: left">Draft</td>
    </tr>
  </tbody>
</table>

<h1 id="abstract">Abstract</h1>

<p>In the future RSK may need to add different types of addresses of different lengths in its Unitrie. Currently the only possible address length is 20 bytes. If this happens, then the length of a trie key will not be enough to uniquely determine the type of a node. In this RSKIP we propose appending a node type identifier to each node that contains data. This will enable future SPV clients to recognize the node type and avoid type-confusion attacks.</p>

<h1 id="discussion">Discussion</h1>

<p>Adding one more byte per node implies more resources will be required to store and transfer the trie state. However the benefits outweigh the drawbacks.</p>

<p>A different approach would be to use some bits that are part of the trie serialization definition to store the type. This idea however is discarded because is mixes elements of different abstraction layers.</p>

<h1 id="specification">Specification</h1>

<p>The non-zero values in the trie are prefixed by the following type specifier as a single byte:</p>

<ul>
  <li>A for account or contract</li>
  <li>S for contract storage cell</li>
  <li>R for contract storage trie root</li>
  <li>D for coDe (C is reserved in case contracts are assigned their own type specifier)</li>
</ul>

<p>Specifiers are shown in ASCII.</p>

<h1 id="copyright"><strong>Copyright</strong></h1>

<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>
