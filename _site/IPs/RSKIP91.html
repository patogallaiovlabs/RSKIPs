<h1 id="static_call-opcode">STATIC_CALL opcode</h1>

<table>
  <thead>
    <tr>
      <th style="text-align: left">RSKIP</th>
      <th style="text-align: left">91</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>Title</strong></td>
      <td style="text-align: left">STATIC_CALL opcode</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Created</strong></td>
      <td style="text-align: left">12-JUL-2018</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Author</strong></td>
      <td style="text-align: left">AE</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Purpose</strong></td>
      <td style="text-align: left">Usa</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Layer</strong></td>
      <td style="text-align: left">Core</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Complexity</strong></td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Status</strong></td>
      <td style="text-align: left">Adopted</td>
    </tr>
  </tbody>
</table>

<p>The following RSKIP is a copy of <a href="https://eips.ethereum.org/EIPS/eip-214">EIP124</a></p>

<h2 id="abstract">Abstract</h2>

<p>To increase smart contract security, this proposal adds a new opcode that can be used to call another contract (or itself) while disallowing any modifications to the state during the call (and its subcalls, if present).</p>

<p>This proposal adds a new opcode that can be used to call another contract (or itself) while disallowing any modifications to the state during the call (and its subcalls, if present). Any opcode that attempts to perform such a modification (see below for details) will result in an exception instead of performing the modification.</p>

<h2 id="motivation">Motivation</h2>

<p>Currently, there is no restriction about what a called contract can do, as long as the computation can be performed with the amount of gas provided. This poses certain difficulties about smart contract engineers; after a regular call, unless you know the called contract, you cannot make any assumptions about the state of the contracts. Furthermore, because you cannot know the order of transactions before they are confirmed by miners, not even an outside observer can be sure about that in all cases.</p>

<p>This EIP adds a way to call other contracts and restrict what they can do in the simplest way. It can be safely assumed that the state of all accounts is the same before and after a static call.</p>

<h2 id="specification">Specification</h2>

<p>Introduce a new <code class="highlighter-rouge">STATIC</code> flag to the virtual machine. This flag is set to <code class="highlighter-rouge">false</code> initially. Its value is always copied to sub-calls with an exception for the new opcode below.</p>

<p>Opcode: <code class="highlighter-rouge">0xfa</code>.</p>

<p><code class="highlighter-rouge">STATICCALL</code> functions equivalently to a <code class="highlighter-rouge">CALL</code>, except it takes only 6 arguments (the “value” argument is not included and taken to be zero), and calls the child with the <code class="highlighter-rouge">STATIC</code> flag set to <code class="highlighter-rouge">true</code> for the execution of the child. Once this call returns, the flag is reset to its value before the call.</p>

<p>Any attempts to make state-changing operations inside an execution instance with <code class="highlighter-rouge">STATIC</code> set to <code class="highlighter-rouge">true</code> will instead throw an exception. These operations include <code class="highlighter-rouge">CREATE</code>, <code class="highlighter-rouge">CREATE2</code>, <code class="highlighter-rouge">LOG0</code>, <code class="highlighter-rouge">LOG1</code>, <code class="highlighter-rouge">LOG2</code>, <code class="highlighter-rouge">LOG3</code>, <code class="highlighter-rouge">LOG4</code>, <code class="highlighter-rouge">SSTORE</code>, and <code class="highlighter-rouge">SELFDESTRUCT</code>. They also include <code class="highlighter-rouge">CALL</code> with a non-zero value. As an exception, <code class="highlighter-rouge">CALLCODE</code> is not considered state-changing, even with a non-zero value.</p>

<h2 id="rationale">Rationale</h2>

<p>This allows contracts to make calls that are clearly non-state-changing, reassuring developers and reviewers that re-entrancy bugs or other problems cannot possibly arise from that particular call; it is a pure function that returns an output and does nothing else. This may also make purely functional HLLs easier to implement.</p>

<h2 id="backwards-compatibility">Backwards compatibility</h2>

<p>This proposal adds a new opcode but does not modify the behaviour of other opcodes and thus is backwards compatible for old contracts that do not use the new opcode and are not called via the new opcode.</p>

<h2 id="copyright"><strong>Copyright</strong></h2>

<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>
