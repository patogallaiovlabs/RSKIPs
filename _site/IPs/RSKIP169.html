<h1 id="rectify-extcodehash-implementation">Rectify EXTCODEHASH implementation</h1>

<table>
  <thead>
    <tr>
      <th style="text-align: left">RSKIP</th>
      <th style="text-align: left">169</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>Title</strong></td>
      <td style="text-align: left">Rectify EXTCODEHASH implementation</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Created</strong></td>
      <td style="text-align: left">JUL-2020</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Author</strong></td>
      <td style="text-align: left">NPS</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Purpose</strong></td>
      <td style="text-align: left">Sca</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Layer</strong></td>
      <td style="text-align: left">Core</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Complexity</strong></td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Status</strong></td>
      <td style="text-align: left">Draft</td>
    </tr>
  </tbody>
</table>

<h1 id="abstract"><strong>Abstract</strong></h1>

<p>EXTCODEHASH opcode was added in RSKIP140 which in turn was modelled after EIP1052.</p>

<p>Because of a wrongly done implementation, test case number 1 of the RSKIP140 (the <code class="highlighter-rouge">EXTCODEHASH</code> of the account without code) was not correctly implemented: it returned 0 instead of <code class="highlighter-rouge">c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470</code> which is the keccack256 hash of empty data. To make things more complex, because of the implementation of MutableCacheImpl, if EXTCODEHASH was run in the same transaction that created the contract, in that case it did return <code class="highlighter-rouge">c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470</code> instead of zero.</p>

<h1 id="specification"><strong>Specification</strong></h1>

<p>Adhere to the right implementation after the activation per RSKIP140.</p>

<h1 id="copyright"><strong>Copyright</strong></h1>

<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.,</p>

