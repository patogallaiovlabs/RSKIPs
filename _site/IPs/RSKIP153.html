<h1 id="add-blake2-compression-function-f-precompile">Add BLAKE2 Compression Function <code class="highlighter-rouge">F</code> Precompile</h1>

<table>
  <thead>
    <tr>
      <th style="text-align: left">RSKIP</th>
      <th style="text-align: left">153</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>Title</strong></td>
      <td style="text-align: left">Add BLAKE2 Compression Function <code class="highlighter-rouge">F</code> Precompile</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Created</strong></td>
      <td style="text-align: left">19-11-2020</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Author</strong></td>
      <td style="text-align: left">FJ</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Purpose</strong></td>
      <td style="text-align: left">Usa</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Layer</strong></td>
      <td style="text-align: left">Core</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Complexity</strong></td>
      <td style="text-align: left">2</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>Status</strong></td>
      <td style="text-align: left">Accepted</td>
    </tr>
  </tbody>
</table>

<h2 id="abstract">Abstract</h2>

<p>This RSKIP introduces a new precompiled contract which implements the compression function F used in the BLAKE2 cryptographic hashing algorithm, for the purpose of allowing interoperability between the EVM and Zcash, as well as introducing more flexible cryptographic hash primitives to the EVM.</p>

<p>Also this RSKIP will make RSK compatible with <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-152.md">EIP-152</a>.</p>

<h2 id="motivation">Motivation</h2>

<p>Besides being a useful cryptographic hash function and SHA3 finalist, BLAKE2 allows for efficient verification of the Equihash PoW used in Zcash, making a BTC Relay - style SPV client possible on RSK. A single verification of an Equihash PoW verification requires 512 iterations of the hash function, making verification of Zcash block headers prohibitively expensive if a Solidity implementation of BLAKE2 is used.</p>

<p>BLAKE2b, the common 64-bit BLAKE2 variant, is highly optimized and faster than MD5 on modern processors.</p>

<p>Interoperability with Zcash could enable contracts like trustless atomic swaps between the chains, which could provide a much needed aspect of privacy to the very public RSK blockchain.</p>

<h2 id="specification">Specification</h2>

<p>This new precompiled contract should be enabled when <code class="highlighter-rouge">blockNumber &gt;= irisHardfork</code>.</p>

<p>The rest of the specification is described in <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-152.md">EIP-152</a>.</p>

<h2 id="references">References</h2>

<p>[1] <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-152.md">EIP-152</a></p>

<p>[2] <a href="https://tools.ietf.org/html/rfc7693#section-3.2">BLAKE2 F</a></p>

<h3 id="copyright">Copyright</h3>

<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>
